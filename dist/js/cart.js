"use strict";window.onload=function(){var e=0;function i(){0===$("main>ul").children("li").length?($("main>div").css({display:"none"}),$("main").css({paddingTop:"490px",background:"rgb(245, 245, 245) url(../img/cart_bg.png) center top no-repeat"}),$("main>fieldset legend").text("为您推荐")):($("main>div").css({display:"flex"}),$("main").css({paddingTop:0,background:"rgb(245, 245, 245)"}),$("main>fieldset legend").text("买购物车中商品的人还买了"))}function n(n,t){$("".concat(n)).click(function(){$(".del").css({top:"-300px"}),$(".cover").css({display:"none"}),t&&t()})}function a(){for(var n=0,t=0;t<$("main>ul").children("li").length;t++)n+=Number($("main>ul").children("li").eq(t).children("p").children("span").text()),e=n;n=0,$("main>div:nth-of-type(2)>p span:eq(0)").text(e),localStorage.setItem("num",e)}i(),$("ul>li").attr({flag:!1}),n(".del>em"),n(".cover",function(){$(".settle").css({top:"-1000px"})}),$.ajax({url:"../json/cart.json",dataType:"json",success:function(n){for(var t=n,e="",i=0;i<t.name.length;i++)e+='<li><img src="'.concat(t.imgSrc[i],'"><p>').concat(t.name[i],"</p><span><span>").concat(t.price[i],"</span>元</span><strong>").concat(t.praise[i],"人好评</strong><i>加入购物车</i></li>"),$("main>fieldset>ul").html(e)}});var t=[],p=[];function s(){if(localStorage.getItem("goodsList")){p=localStorage.getItem("goodsList").split(",");for(var n=0;n<p.length;n+=4)t=p.slice(n,n+4),$("main>ul").append($("<li data-id=".concat(t[2],'><input type="checkbox"><img src="').concat(t[0],'"><span>').concat(t[1],"</span><strong><span><span>").concat(t[2],"</span>元</span></strong><p><b>-</b><span>1</span><em>+</em></p><span><span>").concat(t[2],"</span>元</span><i>X</i></li>"))),$("main>ul li").last().prop({newflag:!1}),$("main>div:nth-of-type(2)>p span:eq(0)").text()?$("main>div:nth-of-type(2)>p span:eq(0)").text(Number($("main>div:nth-of-type(2)>p span:eq(0)").text())+1):$("main>div:nth-of-type(2)>p span:eq(0)").text(1),i(),a()}}s(),$("main>fieldset>ul").on("click","i",function(){$("main>ul").append($('<li data-id=111111><input type="checkbox"><img src="'.concat($(this).parent().children("img").attr("src"),'"><span>').concat($(this).parent().children("p").text(),"</span><strong><span><span>").concat($(this).parent().children("span").children("span").text(),"</span>元</span></strong><p><b>-</b><span>1</span><em>+</em></p><span><span>").concat($(this).parent().children("span").children("span").text(),"</span>元</span><i>X</i></li>"))),$("main>ul li").last().prop({newflag:!1}),i(),$("main>div:nth-of-type(2)>p span:eq(0)").text()?$("main>div:nth-of-type(2)>p span:eq(0)").text(Number($("main>div:nth-of-type(2)>p span:eq(0)").text())+1):$("main>div:nth-of-type(2)>p span:eq(0)").text(1),a(),console.log($("main>ul").children("li").length)}),$("main>ul").on("click","i",function(){$(this).parent().attr({flag:!0}).siblings("li").attr({flag:!1}),$(".del").css({top:"40px"}),$(".cover").css({display:"block"}),$(this).parents("li").prop("a",!0).siblings().prop("a",!1);var t=$(this).parents("li");n(".del>p span:nth-of-type(1)"),n(".del>p span:nth-of-type(2)",function(){$("li[flag=true]").remove(),a(),0===$("main>ul").children("li").length&&i();for(var n=0;n<p.length;n+=4)if(t.data("id")==p[2+n]){p.splice(p.indexOf(p[2+n])-2,4),localStorage.setItem("goodsList",p),console.log(1);break}s()})}),$("main>ul").on("click","em",function(){10<=Number($(this).prev("span").text())?($(this).prev("span").text(10),alert("您所购买的商品数量已达上限")):$(this).prev("span").text(Number($(this).prev("span").text())+1),a(),$(this).parents("li").children("span").eq(1).children("span").text((Number($(this).prev("span").text())*$(this).parents("li").children("strong").children("span").children("span").text()).toFixed(2))}),$("main>ul").on("click","b",function(){Number($(this).next("span").text())<=1?$(this).next("span").text(1):$(this).next("span").text(Number($(this).next("span").text())-1),a(),$(this).parents("li").children("span").eq(1).children("span").text((Number($(this).next("span").text())*$(this).parents("li").children("strong").children("span").children("span").text()).toFixed(2))});var c=0,l=0;$("main>div:nth-of-type(1) span:eq(0)").click(function(){$(this).parents("main").children("ul").children().children("input").prop({checked:!0})}),$("main>ul").on("click","input",function(){!0===$(this).prop("checked")?(c+=Number($(this).parent().children("span").eq(1).children("span").text()),l+=Number($(this).parent().children("p").children("span").text())):(c-=Number($(this).parent().children("span").eq(1).children("span").text()),l-=Number($(this).parent().children("p").children("span").text()))}),$("main>div:nth-of-type(2)>span:nth-of-type(1)").click(function(){for(var n=0,t=0,e=0;e<$("main>ul").children("li").length;e++)$(this).parent().prev().children("li").eq(e).children("input").prop("checked")&&(n+=Number($("main>ul").children("li").eq(e).children("span").eq(1).children("span").text()),t+=Number($("main>ul").children("li").eq(e).children("p").children("span").text())),c=n,l=t;t=n=0,$(".settle").css({top:0}).text("您选择了".concat(l,"件商品，一共要消费").concat(c,"元")),$(".cover").css({display:"block"})})};